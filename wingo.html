<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Win Go - CK WIN</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        * { margin:0; padding:0; box-sizing:border-box; font-family: 'Segoe UI', sans-serif; -webkit-tap-highlight-color: transparent; }
        body { background: #f5f6fa; padding-bottom: 30px; }

        /* ব্যালেন্স সেকশন */
        .balance-card { background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%); margin: 15px; padding: 20px; border-radius: 20px; color: white; position: relative; box-shadow: 0 10px 20px rgba(79, 172, 254, 0.3); }
        .bal-title { font-size: 14px; opacity: 0.9; display: flex; align-items: center; gap: 8px; }
        .amount { font-size: 28px; font-weight: bold; margin: 10px 0; display: block; }
        .btn-group { display: flex; gap: 10px; margin-top: 15px; }
        .btn-group button { flex: 1; padding: 10px; border-radius: 25px; border: none; font-weight: bold; cursor: pointer; }
        .withdraw { background: #fff; color: #4facfe; }
        .deposit { background: #00e676; color: #fff; }

        /* গেম মোড ট্যাব */
        .game-modes { display: flex; justify-content: space-around; background: #fff; margin: 15px; padding: 10px; border-radius: 15px; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .mode-item { text-align: center; cursor: pointer; padding: 5px 10px; border-radius: 10px; transition: 0.3s; filter: grayscale(1); opacity: 0.6; }
        .mode-item.active { background: #fff0f0; filter: grayscale(0); opacity: 1; border: 1px solid #ff4d4d; }
        .mode-item i { font-size: 24px; color: #ff4d4d; display: block; margin-bottom: 5px; }
        .mode-item span { font-size: 11px; font-weight: bold; color: #333; }

        /* টাইমার ও পিরিয়ড সেকশন */
        .timer-box { background: #fff; margin: 15px; padding: 15px; border-radius: 15px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #ff4d4d; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        .period-id { font-size: 14px; font-weight: bold; color: #666; }
        .period-id b { display: block; color: #333; font-size: 16px; margin-top: 4px; }
        .countdown { text-align: right; }
        .countdown span { font-size: 12px; color: #888; font-weight: bold; }
        .time-display { display: flex; gap: 5px; margin-top: 5px; }
        .time-display div { background: #f0f0f0; color: #ff4d4d; padding: 5px 8px; border-radius: 5px; font-weight: 900; font-size: 20px; }

        /* বেটিং বোর্ড */
        .bet-board { background: #fff; margin: 15px; padding: 15px; border-radius: 15px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); }
        .color-btns { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 20px; }
        .color-btns button { padding: 12px; border: none; border-radius: 8px; color: white; font-weight: bold; font-size: 16px; cursor: pointer; }
        .green { background: #18b660; }
        .violet { background: #9c27b0; }
        .red { background: #ff4d4d; }

        .number-grid { display: grid; grid-template-columns: repeat(5, 1fr); gap: 10px; margin-bottom: 20px; }
        .num-btn { aspect-ratio: 1; border-radius: 50%; border: 2px solid #eee; background: #fff; font-size: 18px; font-weight: bold; cursor: pointer; transition: 0.2s; }
        .num-btn:active { transform: scale(0.9); background: #eee; }

        /* বিগ/স্মল বাটন */
        .big-small { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .big-small button { padding: 15px; border: none; border-radius: 30px; font-weight: bold; font-size: 18px; cursor: pointer; color: white; }
        .big { background: #ffa000; }
        .small { background: #2196f3; }

        /* হিস্ট্রি টেবিল */
        .history-section { margin: 15px; }
        table { width: 100%; background: #fff; border-radius: 10px; overflow: hidden; border-collapse: collapse; box-shadow: 0 4px 10px rgba(0,0,0,0.05); }
        th { background: #f8f9fa; padding: 12px; font-size: 12px; color: #777; }
        td { padding: 12px; text-align: center; border-bottom: 1px solid #eee; font-size: 13px; font-weight: bold; }
        .res-num { width: 25px; height: 25px; display: inline-flex; align-items: center; justify-content: center; border-radius: 50%; color: white; }
    </style>
</head>
<body>

    <div class="balance-card">
        <div class="bal-title"><i class="fas fa-wallet"></i> Wallet balance</div>
        <span class="amount">৳ <span id="userBalance">0.00</span></span>
        <div class="btn-group">
            <button class="withdraw" onclick="location.href='withdraw.html'">Withdraw</button>
            <button class="deposit" onclick="location.href='deposit.html'">Deposit</button>
        </div>
    </div>

    <div class="game-modes">
        <div class="mode-item active" id="mode30" onclick="switchMode(30)">
            <i class="fas fa-clock"></i>
            <span>WinGo 30s</span>
        </div>
        <div class="mode-item" id="mode60" onclick="switchMode(60)">
            <i class="fas fa-history"></i>
            <span>WinGo 1Min</span>
        </div>
        <div class="mode-item" id="mode180" onclick="switchMode(180)">
            <i class="fas fa-stopwatch"></i>
            <span>WinGo 3Min</span>
        </div>
    </div>

    <div class="timer-box">
        <div class="period-id">
            Period
            <b id="periodId">202601130001</b>
        </div>
        <div class="countdown">
            <span>Time remaining</span>
            <div class="time-display">
                <div id="min0">0</div>
                <div id="min1">0</div>
                <div style="background:transparent; color:#333; padding:5px 0;">:</div>
                <div id="sec0">0</div>
                <div id="sec1">0</div>
            </div>
        </div>
    </div>

    <div class="bet-board">
        <div class="color-btns">
            <button class="green" onclick="openBetPopup('Green')">Green</button>
            <button class="violet" onclick="openBetPopup('Violet')">Violet</button>
            <button class="red" onclick="openBetPopup('Red')">Red</button>
        </div>

        <div class="number-grid">
            <button class="num-btn" style="color: #9c27b0; border-color: #9c27b0;" onclick="openBetPopup(0)">0</button>
            <button class="num-btn" style="color: #18b660;" onclick="openBetPopup(1)">1</button>
            <button class="num-btn" style="color: #ff4d4d;" onclick="openBetPopup(2)">2</button>
            <button class="num-btn" style="color: #18b660;" onclick="openBetPopup(3)">3</button>
            <button class="num-btn" style="color: #ff4d4d;" onclick="openBetPopup(4)">4</button>
            <button class="num-btn" style="color: #18b660;" onclick="openBetPopup(5)">5</button>
            <button class="num-btn" style="color: #ff4d4d;" onclick="openBetPopup(6)">6</button>
            <button class="num-btn" style="color: #18b660;" onclick="openBetPopup(7)">7</button>
            <button class="num-btn" style="color: #ff4d4d;" onclick="openBetPopup(8)">8</button>
            <button class="num-btn" style="color: #18b660;" onclick="openBetPopup(9)">9</button>
        </div>

        <div class="big-small">
            <button class="big" onclick="openBetPopup('Big')">Big</button>
            <button class="small" onclick="openBetPopup('Small')">Small</button>
        </div>
    </div>

    <div class="history-section">
        <h3 style="padding: 10px; font-size: 15px; color: #444;">Game History</h3>
        <table>
            <thead>
                <tr>
                    <th>Period</th>
                    <th>Number</th>
                    <th>Big Small</th>
                    <th>Color</th>
                </tr>
            </thead>
            <tbody id="historyTable">
                </tbody>
        </table>
    </div>

    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-app.js";
        import { getDatabase, ref, onValue } from "https://www.gstatic.com/firebasejs/10.7.1/firebase-database.js";

        const firebaseConfig = { databaseURL: "https://ck-win-36ca8-default-rtdb.firebaseio.com" };
        const app = initializeApp(firebaseConfig);
        const db = getDatabase(app);

        let currentDuration = 30; // ডিফল্ট ৩০ সেকেন্ড

        // ১. ব্যালেন্স লোড করা
        const userKey = localStorage.getItem("userKey");
        onValue(ref(db, `users/${userKey}/balance`), (snap) => {
            document.getElementById('userBalance').innerText = parseFloat(snap.val() || 0).toFixed(2);
        });

        // ২. টাইমার ফাংশন
        function updateTimer() {
            const now = new Date();
            const totalSeconds = (now.getMinutes() * 60) + now.getSeconds();
            const remaining = currentDuration - (totalSeconds % currentDuration);
            
            // পিরিয়ড আইডি জেনারেশন
            const pId = now.getFullYear().toString() + (now.getMonth() + 1).toString().padStart(2, '0') + now.getDate().toString().padStart(2, '0') + "1000" + Math.floor(totalSeconds / currentDuration);
            document.getElementById('periodId').innerText = pId;

            // টাইম ডিসপ্লে
            const m = Math.floor(remaining / 60);
            const s = remaining % 60;
            document.getElementById('min0').innerText = Math.floor(m / 10);
            document.getElementById('min1').innerText = m % 10;
            document.getElementById('sec0').innerText = Math.floor(s / 10);
            document.getElementById('sec1').innerText = s % 10;
        }

        setInterval(updateTimer, 1000);

        // ৩. মোড সুইচ ফাংশন
        window.switchMode = (duration) => {
            currentDuration = duration;
            document.querySelectorAll('.mode-item').forEach(el => el.classList.remove('active'));
            if(duration === 30) document.getElementById('mode30').classList.add('active');
            if(duration === 60) document.getElementById('mode60').classList.add('active');
            if(duration === 180) document.getElementById('mode180').classList.add('active');
        };

        window.openBetPopup = (type) => {
            let amount = prompt(`Betting on: ${type}\nEnter Amount:`, "10");
            if(amount && amount >= 1) {
                alert(`Bet Placed: ৳${amount} on ${type}`);
                // এখানে আপনার ডাটাবেসে বেট সেভ করার লজিক বসবে
            }
        };
    </script>
</body>
</html>
